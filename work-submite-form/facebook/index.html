<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Facebook Work Submit Form</title>
  <style>
    /* ‡¶•‡¶ø‡¶Æ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤ */
    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f0f2f5;
      --text-primary: #1c1e21;
      --text-secondary: #65676b;
      --border-color: #dddfe2;
      --shadow-color: rgba(0, 0, 0, 0.12);
      --card-bg: #ffffff;
      --input-bg: #f5f6f7;
      --button-bg: #1877f2;
      --button-hover: #166fe5;
      --button-disabled: #dddfe2;
      --button-disabled-text: #bcc0c4;
      --readonly-bg: #f0f2f5;
      --readonly-text: #65676b;
      --readonly-border: #e4e6eb;
    }

    /* ‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶•‡¶ø‡¶Æ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤ */
    [data-theme="dark"] {
      --bg-primary: #18191a;
      --bg-secondary: #242526;
      --text-primary: #e4e6eb;
      --text-secondary: #b0b3b8;
      --border-color: #3e4042;
      --shadow-color: rgba(0, 0, 0, 0.4);
      --card-bg: #242526;
      --input-bg: #3a3b3c;
      --button-bg: #1877f2;
      --button-hover: #166fe5;
      --button-disabled: #3a3b3c;
      --button-disabled-text: #b0b3b8;
      --readonly-bg: #3a3b3c;
      --readonly-text: #b0b3b8;
      --readonly-border: #4e4f50;
    }

    /* Global Styles */
    body { 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%); 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        min-height: 100vh; 
        margin: 0; 
        height: 100%;
        color: var(--text-primary);
        transition: background 0.3s ease, color 0.3s ease;
    }

    .form-container { 
        background: var(--card-bg); 
        padding: 35px; 
        border-radius: 12px; 
        box-shadow: 0 8px 24px var(--shadow-color); 
        width: 90%; 
        max-width: 600px; 
        transition: background 0.3s ease, box-shadow 0.3s ease;
    }

    /* Form Header */ 
    .form-container h2 { 
        text-align: center; 
        margin-bottom: 25px; 
        color: #1877f2;
        font-size: 24px;
        font-weight: 600;
    }

    /* Form Group */ 
    .form-group { 
        display: flex; 
        justify-content: space-between; 
        margin-bottom: 20px; 
        gap: 12px; 
    }

    .form-item { 
        flex: 1; 
    }

    label { 
        display: block; 
        font-weight: 600; 
        margin-bottom: 8px; 
        color: var(--text-primary);
        font-size: 14px;
    }

    select, input { 
        width: 100%; 
        padding: 12px; 
        border: 1px solid var(--border-color); 
        border-radius: 6px; 
        font-size: 14px; 
        box-sizing: border-box; 
        transition: all 0.2s ease; 
        background-color: var(--input-bg);
        color: var(--text-primary);
    }

    select:focus, input:focus { 
        border-color: #1877f2; 
        outline: none;
        box-shadow: 0 0 0 2px rgba(24, 119, 242, 0.2);
        background-color: var(--card-bg);
    }

    /* Read-only input styling */
    input[readonly] {
        background-color: var(--readonly-bg);
        cursor: not-allowed;
        color: var(--readonly-text);
        border-color: var(--readonly-border);
    }

    /* Single Input */ 
    .form-single { 
        margin-bottom: 20px; 
    }

    button { 
        width: 100%; 
        padding: 14px; 
        background-color: var(--button-bg); 
        color: #ffffff; 
        border: none; 
        border-radius: 6px; 
        font-size: 16px; 
        font-weight: 600;
        cursor: pointer; 
        transition: background-color 0.2s; 
        margin-top: 10px;
    }

    button:hover { 
        background-color: var(--button-hover); 
    }

    button:disabled { 
        background-color: var(--button-disabled); 
        cursor: not-allowed; 
        color: var(--button-disabled-text);
    }

    /* ‚úÖ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶™‡¶™-‡¶Ü‡¶™ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    #custom-alert {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    /* üìå ‡¶™‡¶™-‡¶Ü‡¶™ ‡¶¨‡¶ï‡ßç‡¶∏ */
    .alert-box {
        background: var(--card-bg);
        padding: 25px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 4px 20px var(--shadow-color);
        min-width: 300px;
        max-width: 90%;
        color: var(--text-primary);
    }

    /* üìù ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
    .alert-box p {
        margin: 0 0 20px;
        font-size: 16px;
        line-height: 1.5;
        color: var(--text-primary);
    }

    /* üéØ OK ‡¶¨‡¶æ‡¶ü‡¶® */
    #alert-ok {
        width: 100px;
        height: 40px;
        background: var(--button-bg);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: background-color 0.2s;
    }

    #alert-ok:hover {
        background: var(--button-hover);
    }

    /* Go Back */ 
    .styled-wrapper {
      position: fixed;
      bottom: 20px;
      left: 10px;
      z-index: 10;
    }

    .styled-wrapper .button {
      display: block;
      position: relative;
      width: 65px;
      height: 65px;
      margin: 0;
      overflow: hidden;
      outline: none;
      background-color: transparent;
      cursor: pointer;
      border: 0;
    }

    .styled-wrapper .button:before {
      content: "";
      position: absolute;
      border-radius: 20%;
      inset: 7px;
      border: 3px solid var(--text-primary);
      transition:
        opacity 0.4s cubic-bezier(0.77, 0, 0.175, 1) 80ms,
        transform 0.5s cubic-bezier(0.455, 0.03, 0.515, 0.955) 80ms;
    }

    .styled-wrapper .button:after {
      content: "";
      position: absolute;
      border-radius: 20%;
      inset: 7px;
      border: 4px solid #599a53;
      transform: scale(1.3);
      transition:
        opacity 0.4s cubic-bezier(0.165, 0.84, 0.44, 1),
        transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      opacity: 0;
    }

    .styled-wrapper .button:hover:before,
    .styled-wrapper .button:focus:before {
      opacity: 0;
      transform: scale(0.7);
      transition:
        opacity 0.4s cubic-bezier(0.165, 0.84, 0.44, 1),
        transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .styled-wrapper .button:hover:after,
    .styled-wrapper .button:focus:after {
      opacity: 1;
      transform: scale(1);
      transition:
        opacity 0.4s cubic-bezier(0.77, 0, 0.175, 1) 80ms,
        transform 0.5s cubic-bezier(0.455, 0.03, 0.515, 0.955) 80ms;
    }

    .styled-wrapper .button-box {
      display: flex;
      position: absolute;
      top: 0;
      left: 0;
    }

    .styled-wrapper .button-elem {
      display: block;
      width: 30px;
      height: 30px;
      margin: 18px 18px 0 18px;
      transform: rotate(360deg);
      fill: var(--text-primary);
    }

    .styled-wrapper .button:hover .button-box,
    .styled-wrapper .button:focus .button-box {
      transition: 0.4s;
      transform: translateX(-69px);
    }

    /* ‡¶•‡¶ø‡¶Æ ‡¶ü‡¶ó‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 10px var(--shadow-color);
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    .theme-toggle svg {
      width: 24px;
      height: 24px;
      fill: var(--text-primary);
    }

    .sun-icon {
      display: none;
    }

    [data-theme="dark"] .moon-icon {
      display: none;
    }

    [data-theme="dark"] .sun-icon {
      display: block;
    }
  </style>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
</head>
<body>
  <!-- ‡¶•‡¶ø‡¶Æ ‡¶ü‡¶ó‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® -->
  <div class="theme-toggle" id="theme-toggle">
    <svg class="moon-icon" viewBox="0 0 24 24">
      <path d="M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36c-0.98,1.37-2.58,2.26-4.4,2.26 c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/>
    </svg>
    <svg class="sun-icon" viewBox="0 0 24 24">
      <path d="M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5S14.76,7,12,7L12,7z M12,2L12,2L12,2L12,2L12,2z M12,22L12,22L12,22L12,22L12,22z M2,12L2,12L2,12L2,12L2,12z M22,12L22,12L22,12L22,12L22,12z M5.64,7.05L5.64,7.05L5.64,7.05L5.64,7.05L5.64,7.05z M18.36,7.05L18.36,7.05L18.36,7.05L18.36,7.05L18.36,7.05z M5.64,16.95L5.64,16.95L5.64,16.95L5.64,16.95L5.64,16.95z M18.36,16.95L18.36,16.95L18.36,16.95L18.36,16.95L18.36,16.95z"/>
    </svg>
  </div>

  <div class="form-container">
    <h2>Work Submit --</h2>
    
    <!-- First Set -->
    <div class="form-group">
      <div class="form-item">
        <label for="account-type">Account Type:</label>
        <select id="account-type" required>
          <option disabled>--Select-- </option>
          <option selected>Facebook</option>
        </select>
      </div>
      <div class="form-item">
        <label for="mail-box">Mail Box:</label>
        <select id="mail-box" required>
          <option disabled selected>Select</option>
          <option > Web Mail </option>
          <option > Trusted Hotmail </option>
          <option > Trusted Outlook </option>
          <option>Temp Mail</option>
          <option selected>Any Mail</option>
          <option > Sort Mail </option>
        </select>
      </div>
    </div>

    <!-- Second Set -->
    <div class="form-group">
      <div class="form-item">
        <label for="2fa-cookie">2FA-Cook</label>
        <select id="2fa-cookie">
          <option disabled selected>--Select--</option>
          <option value="2FA">2FA</option>
          <option value="Cookies">Cookies</option>
        </select>
      </div>
      <div class="form-item">
        <label for="fd-tpe">Friends:</label>
        <select id="fd-type">
          <option disabled selected>--Select--</option>
          <option value="0FD">0FD</option>
          <option value="10FD">10FD</option>
          <option value="20FD">20FD</option>
          <option value="30FD">30FD</option>
        </select>
      </div>
      <div class="form-item">
        <label for="ttl-id">Total Id:</label>
        <input type="text" id="ttl-id" placeholder="Total Id" maxlength="4">
      </div>
    </div>

    <!-- Third Set -->
    <div class="form-group">
      <div class="form-item">
        <label for="tg-username">UserName:</label>
        <input type="text" id="tg-username" placeholder="Username" readonly>
      </div>
      <div class="form-item">
        <label for="tg-chat-id">User ID:</label>
        <input type="text" id="tg-chat-id" placeholder="User ID" maxlength="10" readonly>
      </div>
    </div>

    <!-- Single Input -->
    <div class="form-single">
      <label for="google-sheet">File Link:</label>
      <input type="url" id="google-sheet" placeholder="Paste File Link Here">
    </div>

    <button type="submit" id="submit-btn">Submit</button>
  </div>
  
  <!-- ‚úÖ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶™‡¶™-‡¶Ü‡¶™ -->
  <div id="custom-alert" class="hidden">
      <div class="alert-box">
          <p id="alert-message"></p>
          <button id="alert-ok">OK</button>
      </div>
  </div>

  <!-- Go Back --> 
  <div class="styled-wrapper">
    <button onclick="goBack()" class="button">
      <div class="button-box">
        <span class="button-elem">
          <svg
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
            class="arrow-icon"
          >
            <path
              fill="currentColor"
              d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"
            ></path>
          </svg>
        </span>
        <span class="button-elem">
          <svg
            fill="currentColor"
            viewBox="0 0  24 24"
            xmlns="http://www.w3.org/2000/svg"
            class="arrow-icon"
          >
            <path
              d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"
            ></path>
          </svg>
        </span>
      </div>
    </button>
  </div>

  <script>
    // Firebase configuration - replace with your actual config
    const firebaseConfig = {
      apiKey: "AIzaSyCs6ePkTxvMjcERh6yAdvjPqxIu6X7jhRM",
      authDomain: "fbm-market-bot.firebaseapp.com",
      projectId: "fbm-market-bot",
      storageBucket: "fbm-market-bot.firebasestorage.app",
      messagingSenderId: "711610016805",
      appId: "1:711610016805:web:c5a019c9af1485ac984bcc"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // ‡¶•‡¶ø‡¶Æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function initializeTheme() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      // ‡¶•‡¶ø‡¶Æ ‡¶ü‡¶ó‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡¶ø‡¶∏‡ßá‡¶®‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
      document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
    }

    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    }

    // URL ‡¶•‡ßá‡¶ï‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶°‡¶º‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function getUserFromURL() {
      const urlParams = new URLSearchParams(window.location.search);
      const userStr = urlParams.get("user");
      
      if (!userStr) {
        console.log("No user data found in URL");
        return null;
      }
      
      try {
        // URL decode ‡¶è‡¶¨‡¶Ç JSON parse ‡¶ï‡¶∞‡ßÅ‡¶®
        return JSON.parse(decodeURIComponent(userStr));
      } catch (error) {
        console.error("Error parsing user data:", error);
        return null;
      }
    }

    // Firebase-‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function saveToFirebase(formData) {
      const database = firebase.database();
      const newSubmissionRef = database.ref('submissions').push();
      return newSubmissionRef.set(formData);
    }

    // DOM ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ö‡¶ü‡ßã-‡¶´‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
    document.addEventListener('DOMContentLoaded', function() {
      // ‡¶•‡¶ø‡¶Æ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®
      initializeTheme();
      
      const user = getUserFromURL();
      
      if (user) {
        // username ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        document.getElementById('tg-username').value = user.username ? '@' + user.username : '';
        
        // user ID (chat ID) ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        document.getElementById('tg-chat-id').value = user.id || '';
        
        // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶≠‡ßá‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶¨‡¶≤‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
        window.userData = user;
      } else {
        // Fallback ‡¶Ø‡¶¶‡¶ø user data ‡¶®‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º
        document.getElementById('tg-username').value = '@username';
        document.getElementById('tg-chat-id').value = '';
      }
    });

    // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶è‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function showAlert(message) {
      const alertBox = document.getElementById("custom-alert");
      const alertMessage = document.getElementById("alert-message");
      
      alertMessage.textContent = message;
      alertBox.style.display = "flex";
    }

    document.getElementById("alert-ok").addEventListener("click", function () {
      document.getElementById("custom-alert").style.display = "none";
    });

    // ‡¶ó‡ßã ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function goBack() {
      window.history.back();
    }

    // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®
    document.getElementById("account-type").addEventListener("change", function () { 
      const accountType = this.value.toLowerCase(); 
      const mailBox = document.getElementById("mail-box"); 
      const cookie2fa = document.getElementById("2fa-cookie"); 
      const fdType = document.getElementById("fd-type");

      mailBox.disabled = false;
      mailBox.required = true;
      cookie2fa.disabled = false;
      cookie2fa.required = true;
      fdType.disabled = false;
      fdType.required = true;

      if (cookie2fa.value === "Cookies") {
          fdType.disabled = true;
          fdType.value = "";
      } else {
          fdType.disabled = false;
      }
    });

    document.getElementById("2fa-cookie").addEventListener("change", function () { 
      const fdType = document.getElementById("fd-type"); 
      if (this.value === "Cookies") { 
          fdType.disabled = true; 
          fdType.value = ""; 
      } else { 
          fdType.disabled = false; 
      }
    });

    document.getElementById("submit-btn").addEventListener("click", function () { 
      const accountType = document.getElementById("account-type").value; 
      const mailBox = document.getElementById("mail-box").value || " "; 
      const cookie2fa = document.getElementById("2fa-cookie").value.trim();
      const fdType = document.getElementById("fd-type").value || " "; 
      const ttlId = document.getElementById("ttl-id").value; 
      const tgUsername = document.getElementById("tg-username").value.trim();
      const tgChatId = document.getElementById("tg-chat-id").value; 
      const googleSheet = document.getElementById("google-sheet").value;

      // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ @ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
      if (!tgUsername.startsWith("@")) {
          showAlert(" ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá '@' ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§ ");
          return;
      }

      const requiredFields = [
          { value: accountType, name: "Account Type" },
          { value: cookie2fa, name: "2FA/Cookies" },
          { value: ttlId, name: "Ttl Id" },
          { value: tgUsername, name: "Tg Username" },
          { value: tgChatId, name: "Tg Chat Id" },
          { value: googleSheet, name: "Google Sheet Link" }
      ];

      for (const field of requiredFields) {
          if (!field.value || field.value === "Select") {
              showAlert(`Please fill out the ${field.name}.`);
              return;
          }
      }

      if (!/^\d{1,4}$/.test(ttlId)) {
          showAlert("Ttl Id must be between 1 and 4 digits.");
          return;
      }

      if (!/^\d{9,10}$/.test(tgChatId)) {
          showAlert("Tg Chat Id must be 9 or 10 digits.");
          return;
      }

      const sheetLinkRegex = /^https?:\/\/(docs\.google\.com\/spreadsheets\/.+)/;
      if (!sheetLinkRegex.test(googleSheet)) {
          showAlert("Please enter a valid Google Sheet link.");
          return;
      }

      let chatIdForBot;

      if (cookie2fa === "Cookies") {
          chatIdForBot = "-1002372301785";
      } else if (cookie2fa === "2FA" &&  fdType === "30FD") {
          chatIdForBot = "-1002635815704";
      } else if (cookie2fa === "2FA" &&  fdType === "0FD") {
          chatIdForBot = "-1002636197141";
      } else if (cookie2fa === "2FA" &&  fdType === "10FD") {
          chatIdForBot = "-1002654345940";
      } else {
          showAlert("‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá 2FA ‡¶¨‡¶æ Cookies ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
          return;
      }

      const options = { 
          timeZone: "Asia/Dhaka", 
          day: "2-digit", 
          month: "2-digit", 
          year: "numeric",
          hour: "2-digit", 
          minute: "2-digit", 
          second: "2-digit",
          hour12: true 
      };
      const currentDate = new Date().toLocaleString("en-GB", options).replace(",", "");

      // ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶° ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
      const message = `
‚úÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®

üìã ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£:
‚Ä¢ AccType: ${accountType}
‚Ä¢ Mbox: ${mailBox}
‚Ä¢ 2FA/Cook: ${cookie2fa}
‚Ä¢ fType: ${fdType}

‚Ä¢ uName: ${tgUsername}
‚Ä¢ UID: ${tgChatId}
‚Ä¢ tID: ${ttlId}

üìé fLink: ${googleSheet}

üïê D&T ${currentDate}
      `;

      const botToken = "7673657711:AAG9aHlpI8_Egvwi0fY9rxA4qyEfqOw16nU";
      const telegramUrl = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatIdForBot}&text=${encodeURIComponent(message)}`;

      const submitBtn = document.getElementById("submit-btn");
      submitBtn.disabled = true;

      // Firebase-‡¶è ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§ - ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶π‡¶¨‡ßá
      const formData = {
        accountType: accountType,
        mailBox: mailBox,
        cookie2fa: cookie2fa,
        fdType: fdType,
        ttlId: ttlId,
        tgUsername: tgUsername,
        tgChatId: tgChatId,
        googleSheet: googleSheet,
        submissionTime: currentDate,
        timestamp: new Date().getTime(),
        // Telegram user data ‡¶ì ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
        telegramUserId: window.userData?.id || '',
        telegramUsername: window.userData?.username || ''
      };

      // 1. ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá Telegram ‡¶¨‡¶ü‡ßá ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®
      fetch(telegramUrl)
          .then(async (response) => {
              const result = await response.json();
              
              if (response.status >= 200 && response.status < 300) {
                  console.log("Telegram API Success:", result);
                  
                  // 2. ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ Telegram ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá Firebase-‡¶è ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
                  return saveToFirebase(formData)
                      .then(() => {
                          console.log("Data saved to Firebase successfully");
                          // 3. Firebase ‡¶∏‡ßá‡¶≠ ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶™‡¶æ‡¶†‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                          sendReadyMadeMessageToUser(tgChatId);
                          
                          // ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡¶∂‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü URL ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£
                          let redirectPage = "success.html"; // ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü
                          
                          if (cookie2fa === "Cookies") {
                              redirectPage = "success/fb-success-cookies.html";
                          } else if (cookie2fa === "2FA" && fdType === "30FD") {
                              redirectPage = "success/fb-success-30fd.html";
                          } else if (cookie2fa === "2FA" && fdType === "0FD") {
                              redirectPage = "success/fb-success-0fd.html";
                          } else if (cookie2fa === "2FA" && fdType === "10FD") {
                              redirectPage = "success/fb-success-10fd.html";
                          }

                          const successData = {
                              profilePicture: window.userData?.photo_url || "",
                              userName: (window.userData?.first_name || "") + " " + (window.userData?.last_name || ""),
                              userUsername: window.userData?.username ? '@' + window.userData.username : '',
                              chatId: window.userData?.id || tgChatId
                          };

                          const encodedData = encodeURIComponent(JSON.stringify(successData));
                          
                          setTimeout(() => {
                              window.location.href = `${redirectPage}?data=${encodedData}`;
                          }, 1000);
                      })
                      .catch((error) => {
                          // ‡¶Ø‡¶¶‡¶ø Firebase-‡¶è ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü
                          console.error("Error saving to Firebase:", error);
                          showAlert("‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
                          submitBtn.disabled = false;
                      });

              } else {
                  // Telegram API error ‡¶π‡¶≤‡ßá
                  console.error("Telegram API Error:", result);
                  showAlert(`Failed: ${result.description || 'Telegram API ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§'}`);
                  submitBtn.disabled = false;
                  // Promise reject ‡¶ï‡¶∞‡¶¨‡ßá ‡¶Ø‡¶æ‡¶§‡ßá catch block ‡¶è ‡¶ö‡¶≤‡ßá ‡¶Ø‡¶æ‡ßü
                  return Promise.reject(new Error(`Telegram API Error: ${result.description}`));
              }
          })
          .catch((error) => {
              // Network error ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶® error ‡¶π‡¶≤‡ßá
              console.error("Network or Other Error:", error);
              showAlert("Failed to send data. Please check your network and try again.");
              submitBtn.disabled = false;
          });
    });

    function sendReadyMadeMessageToUser(tgChatId) {
        const botToken = "botToken7673657711:AAG9aHlpI8_Egvwi0fY9rxA4qyEfqOw16nU";

        const today = new Date().toLocaleString("en-GB", {
            timeZone: "Asia/Dhaka",
            day: "2-digit",
            month: "2-digit",
            year: "numeric",
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
            hour12: true
        });

        const mediaUrl = "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj7TresD68j1z7kGLxwCZwyxX9D2tg_iC5tuUQOnbPpOwTNcRICz91oFLCLP3bzBhIzXKt7sGDSAZC5HvpKvcFjaHhefNIndTl6uGgw7BUh5aN8XD1d2YJs0wol1tfWDIidivg4Fjls0vKLJF-91rPLrEYdJ7v_ZN3VHg2_Y8FQ12a1el9232IgTimTZD0V/s1280/wssfl.png";

        const caption = `Submit Successful üíê \n\n‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶∏‡¶´‡¶≤ ‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ \n\n‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ú‡¶æ‡¶®‡¶§‡ßá ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ó‡ßç‡¶∞‡ßÇ‡¶™‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶•‡¶æ‡¶ï‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶®‡¶ø‡¶®‡•§   \n\n‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${today}`;

        const replyMarkup = {
            inline_keyboard: [[
                {
                    text: "Join Group",
                    url: "https://t.me/fbmMarket"
                }
            ]]
        };

        const apiUrl = `https://api.telegram.org/bot${botToken}/sendPhoto`;

        const formData = {
            chat_id: tgChatId,
            photo: mediaUrl,
            caption: caption,
            reply_markup: JSON.stringify(replyMarkup),
            parse_mode: "HTML"
        };

        fetch(apiUrl, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(formData)
        })
        .then(res => res.json())
        .then(data => {
            if (!data.ok) {
                console.error("Failed to send media message:", data);
            }
        })
        .catch(err => {
            console.error("Error sending media message:", err);
        });
    }
  </script>
</body>
</html>
