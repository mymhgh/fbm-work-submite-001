document.getElementById("account-type").addEventListener("change", function () { 
    const accountType = this.value.toLowerCase(); 
    const mailBox = document.getElementById("mail-box"); 
    const cookie2fa = document.getElementById("2fa-cookie"); 
    const fdType = document.getElementById("fd-type");

    if (["gmail", "instagram", "telegram"].includes(accountType)) {
        mailBox.disabled = true;
        mailBox.required = false;
        cookie2fa.disabled = true;
        cookie2fa.required = false;
        fdType.disabled = true;
        fdType.required = false;

        mailBox.value = "";
        cookie2fa.value = "";
        fdType.value = "";
    } else {
        mailBox.disabled = false;
        mailBox.required = true;
        cookie2fa.disabled = false;
        cookie2fa.required = true;
        fdType.disabled = false;
        fdType.required = true;
    }

    if (cookie2fa.value === "Cookies") {
        fdType.disabled = true;
        fdType.value = "";
    } else {
        fdType.disabled = false;
    }
});

document.getElementById("2fa-cookie").addEventListener("change", function () { 
    const fdType = document.getElementById("fd-type"); 
    if (this.value === "Cookies") { 
        fdType.disabled = true; 
        fdType.value = ""; 
    } else { 
        fdType.disabled = false; 
    }
});

document.getElementById("submit-btn").addEventListener("click", function () { 
    const accountType = document.getElementById("account-type").value; 
    const mailBox = document.getElementById("mail-box").value || " "; 
    const cookie2fa = document.getElementById("2fa-cookie").value.trim();
    const fdType = document.getElementById("fd-type").value || " "; 
    const ttlId = document.getElementById("ttl-id").value; 
    const tgUsername = document.getElementById("tg-username").value.trim(); // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ‡¶ü‡¶ø ‡¶ü‡ßç‡¶∞‡¶ø‡¶Æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
    const tgChatId = document.getElementById("tg-chat-id").value; 
    const googleSheet = document.getElementById("google-sheet").value;




function isValidTelegramUsername(username) {
    const cleaned = username.slice(1); // remove '@'

    if (cleaned.length < 5) return false;

    const hasLetter = /[a-zA-Z]/.test(cleaned);
    const hasNumber = /[0-9]/.test(cleaned);
    const hasSpecial = /[_]/.test(cleaned); // ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ underscore (_) ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá

    // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶á ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶¨‡¶æ ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶á ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶ï‡ßç‡¶ü‡¶æ‡¶∞ ‡¶π‡¶≤‡ßá invalid
    if (!hasLetter) return false;

    // ‡¶Ø‡ßá‡¶π‡ßá‡¶§‡ßÅ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡¶è‡¶ï‡¶ü‡¶æ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶Ü‡¶õ‡ßá, ‡¶è‡¶¨‡¶Ç ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶•‡¶æ‡¶ï‡¶≤‡ßá valid
    return true;
}



    // ‚úÖ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á @ ‡¶¶‡¶ø‡ßü‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá
    if (!tgUsername.startsWith("@")) {
        showAlert(" ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá '@' ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§ ");
        return;
    }

// ‚úÖ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ‡ßá admin, pro, fbm ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶¨‡ßç‡¶≤‡¶ï ‡¶ï‡¶∞‡¶¨
const invalidUsernames = ["admin", "pro", "fbm", "edris"];
const cleanedUsername = tgUsername.slice(1).toLowerCase(); // @ ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨

if (invalidUsernames.includes(cleanedUsername)) {
    if (cleanedUsername === "admin") {
        showAlert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶® ( admin ‚ùå )");
    } else if (cleanedUsername === "pro") {
        showAlert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶® ( pro ‚ùå )");
    } else if (cleanedUsername === "edris") {
        showAlert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶® ( Edris ‚ùå )");
    } else if (cleanedUsername === "fbm") {
        showAlert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶® ( fbm ‚ùå )");
    }
    return;
}


// ‚úÖ ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡ßá‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
if (!isValidTelegramUsername(tgUsername)) {
    showAlert("‡¶∏‡¶†‡¶ø‡¶ï ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶®‡•§");
    return;
}



    const requiredFields = [
        { value: accountType, name: "Account Type" },
        { value: cookie2fa, name: "2FA/Cookies" },
        { value: ttlId, name: "Ttl Id" },
        { value: tgUsername, name: "Tg Username" },
        { value: tgChatId, name: "Tg Chat Id" },
        { value: googleSheet, name: "Google Sheet Link" }
    ];

    for (const field of requiredFields) {
        if (!field.value || field.value === "Select") {
            showAlert(`Please fill out the ${field.name}.`);
            return;
        }
    }

    if (!/^\d{1,4}$/.test(ttlId)) {
        showAlert("Ttl Id must be between 1 and 4 digits.");
        return;
    }

    if (!/^\d{9,10}$/.test(tgChatId)) {
        showAlert("Tg Chat Id must be 9 or 10 digits.");
        return;
    }

    const sheetLinkRegex = /^https?:\/\/(docs\.google\.com\/spreadsheets\/.+)/;
    if (!sheetLinkRegex.test(googleSheet)) {
        showAlert("Please enter a valid Google Sheet link.");
        return;
    }

    let chatIdForBot;

    if (cookie2fa === "Cookies") {
        chatIdForBot = "-1002372301785";
    } else if (cookie2fa === "2FA" &&  fdType === "30FD") {
        chatIdForBot = "-1002635815704";
    } else if (cookie2fa === "2FA" &&  fdType === "0FD") {
        chatIdForBot = "-1002636197141";
    } else if (accountType.toLowerCase() === "gmail") {
        chatIdForBot = "-1002281630040";
    } else if (accountType.toLowerCase() === "instagram") {
        chatIdForBot = "-1002698350138";
    } else if (accountType.toLowerCase() === "telegram") {
        chatIdForBot = "-1002238560040";
    } else {
        showAlert("‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá 2FA ‡¶¨‡¶æ Cookies ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
        return;
    }

    const options = { 
        timeZone: "Asia/Dhaka", 
        day: "2-digit", 
        month: "2-digit", 
        hour: "2-digit", 
        minute: "2-digit", 
        hour12: true 
    };
    const currentDate = new Date().toLocaleString("en-GB", options).replace(",", "");

    const message = `
      New Form Submission:
      - Account Type: ${accountType}
      - Mail Box: ${mailBox}
      - 2FA-Cook: ${cookie2fa}
      - FD Type: ${fdType}
      - Ttl Id: ${ttlId}
      - Tg UsrNM: ${tgUsername}
      - Tg ChatId: ${tgChatId}
      - File: ${googleSheet}
      - D&T: ${currentDate}
    `;

    const botToken = "7734169736:AAGDFW2mVkNSLrrPClDohEfNE0whlwmBiuE";
    const telegramUrl = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatIdForBot}&text=${encodeURIComponent(message)}`;

    const submitBtn = document.getElementById("submit-btn");
    submitBtn.disabled = true;

    fetch(telegramUrl)
        .then(async (response) => {
            const result = await response.json();
            
 if (response.ok) {
    sendReadyMadeMessageToUser(tgChatId); // ‚úÖ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶Ü‡¶á‡¶°‡¶ø‡¶§‡ßá ‡¶Æ‡¶ø‡¶°‡¶ø‡ßü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶ì

    setTimeout(() => {
        window.location.href = "success.html";
    }, 1000);
}
            
            
            
            
            else {
                console.error("Telegram API Error:", result);
                showAlert(`Failed: ${result.description}`);
                submitBtn.disabled = false;
            }
        })
        .catch((error) => {
            console.error("Network Error:", error);
            showAlert("Failed to send data. Please check your network and try again.");
            submitBtn.disabled = false;
        });
});

// ‚úÖ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®: ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ‡¶∂‡ßã ‡¶ï‡¶∞‡¶æ
function showAlert(message) {
    const alertBox = document.getElementById("custom-alert");
    const alertMessage = document.getElementById("alert-message");
    
    alertMessage.textContent = message;  // ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
    alertBox.style.display = "flex";    // ‡¶™‡¶™-‡¶Ü‡¶™ ‡¶∂‡ßã ‡¶ï‡¶∞‡¶æ‡¶®‡ßã
}

// ‚úÖ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®: ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ
document.getElementById("alert-ok").addEventListener("click", function () {
    document.getElementById("custom-alert").style.display = "none";
});







function sendReadyMadeMessageToUser(tgChatId) {
    const botToken = "7673657711:AAHVLLBUQUyW4de_qrZsy2L3Hcj3Siav3kY";

// ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶∏‡¶Æ‡ßü (‡¶∏‡¶æ‡¶≤ ‡¶¨‡¶æ‡¶¶‡ßá)
const today = new Date().toLocaleString("en-GB", {
    timeZone: "Asia/Dhaka",
    day: "2-digit",
    month: "2-digit",
    hour: "2-digit",
    minute: "2-digit",
    hour12: true
});

    // ‡¶Æ‡¶ø‡¶°‡¶ø‡ßü‡¶æ ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï (‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡¶æ ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá)
    const mediaUrl = "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj7TresD68j1z7kGLxwCZwyxX9D2tg_iC5tuUQOnbPpOwTNcRICz91oFLCLP3bzBhIzXKt7sGDSAZC5HvpKvcFjaHhefNIndTl6uGgw7BUh5aN8XD1d2YJs0wol1tfWDIidivg4Fjls0vKLJF-91rPLrEYdJ7v_ZN3VHg2_Y8FQ12a1el9232IgTimTZD0V/s1280/wssfl.png"; // ‡¶á‡¶Æ‡ßá‡¶ú ‡¶¨‡¶æ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï

    const caption = `Submit Successful üíê \n\n‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶∏‡¶´‡¶≤ ‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ \n\n‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ú‡¶æ‡¶®‡¶§‡ßá ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ó‡ßç‡¶∞‡ßÇ‡¶™‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶•‡¶æ‡¶ï‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶®‡¶ø‡¶®‡•§   \n\n‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${today}`;

    const replyMarkup = {
        inline_keyboard: [[
            {
                text: "Join Group",
                url: "https://t.me/fbmMarket" // ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï
            }
        ]]
    };

    // API URL
    const apiUrl = `https://api.telegram.org/bot${botToken}/sendPhoto`; // ‡¶Ø‡¶¶‡¶ø ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶π‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá sendVideo

    // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø
    const formData = {
        chat_id: tgChatId,
        photo: mediaUrl, // ‡¶Ø‡¶¶‡¶ø ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶π‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá "video" key ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá
        caption: caption,
        reply_markup: JSON.stringify(replyMarkup),
        parse_mode: "HTML"
    };

    // ‡¶´‡ßá‡¶ö ‡¶∞‡¶ø‡¶ï‡ßÅ‡ßü‡ßá‡¶∏‡ßç‡¶ü
    fetch(apiUrl, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(formData)
    })
    .then(res => res.json())
    .then(data => {
        if (!data.ok) {
            console.error("Failed to send media message:", data);
        }
    })
    .catch(err => {
        console.error("Error sending media message:", err);
    });
}
